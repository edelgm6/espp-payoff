class VolatilityChart extends EsppChart {

    constructor(canvas) {
        super();
        this.canvas = canvas;
        this.attachChart();
    }

    toggleVolatility(volatility) {

        const volatilitySeriesMap = {
            10: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0001, 0.0003, 0.0006, 0.0012, 0.0024, 0.0046, 0.0085, 0.0153, 0.0265, 0.0444, 0.0716, 0.1112, 0.1666, 0.2405, 0.3347, 0.449, 0.5807, 0.7238, 0.8698, 1.0074, 1.1248, 1.2105, 1.2558, 1.2558, 1.2105, 1.1248, 1.0074, 0.8698, 0.7238, 0.5807, 0.449, 0.3347, 0.2405, 0.1666, 0.1112, 0.0716, 0.0444, 0.0265, 0.0153, 0.0085, 0.0046, 0.0024, 0.0012, 0.0006, 0.0003, 0.0001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            25: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0001, 0.0001, 0.0002, 0.0003, 0.0005, 0.0009, 0.0013, 0.002, 0.0031, 0.0046, 0.0067, 0.0097, 0.0138, 0.0194, 0.0267, 0.0364, 0.0488, 0.0646, 0.0841, 0.108, 0.1366, 0.1703, 0.2092, 0.2532, 0.302, 0.355, 0.4112, 0.4693, 0.5278, 0.585, 0.6389, 0.6876, 0.7292, 0.7621, 0.7848, 0.7964, 0.7964, 0.7848, 0.7621, 0.7292, 0.6876, 0.6389, 0.585, 0.5278, 0.4693, 0.4112, 0.355, 0.302, 0.2532, 0.2092, 0.1703, 0.1366, 0.108, 0.0841, 0.0646, 0.0488, 0.0364, 0.0267, 0.0194, 0.0138, 0.0097, 0.0067, 0.0046, 0.0031, 0.002, 0.0013, 0.0009, 0.0005, 0.0003, 0.0002, 0.0001, 0.0001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
            50: [0.0001, 0.0001, 0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0007, 0.001, 0.0014, 0.0018, 0.0024, 0.0032, 0.0042, 0.0055, 0.0071, 0.0091, 0.0117, 0.0147, 0.0185, 0.0231, 0.0286, 0.0351, 0.0428, 0.0518, 0.0622, 0.0742, 0.0879, 0.1033, 0.1205, 0.1396, 0.1605, 0.1832, 0.2076, 0.2334, 0.2606, 0.2889, 0.3178, 0.3471, 0.3763, 0.405, 0.4327, 0.4589, 0.4831, 0.5049, 0.5237, 0.5394, 0.5514, 0.5595, 0.5637, 0.5637, 0.5595, 0.5514, 0.5394, 0.5237, 0.5049, 0.4831, 0.4589, 0.4327, 0.405, 0.3763, 0.3471, 0.3178, 0.2889, 0.2606, 0.2334, 0.2076, 0.1832, 0.1605, 0.1396, 0.1205, 0.1033, 0.0879, 0.0742, 0.0622, 0.0518, 0.0428, 0.0351, 0.0286, 0.0231, 0.0185, 0.0147, 0.0117, 0.0091, 0.0071, 0.0055, 0.0042, 0.0032, 0.0024, 0.0018, 0.0014, 0.001, 0.0007, 0.0005, 0.0004, 0.0003, 0.0002, 0.0001, 0.0001, 0.0001],
            75: [0.0011, 0.0015, 0.0018, 0.0023, 0.0029, 0.0036, 0.0045, 0.0055, 0.0068, 0.0083, 0.0101, 0.0122, 0.0147, 0.0176, 0.021, 0.025, 0.0295, 0.0347, 0.0406, 0.0472, 0.0547, 0.063, 0.0723, 0.0825, 0.0937, 0.1059, 0.1191, 0.1334, 0.1485, 0.1646, 0.1815, 0.1993, 0.2176, 0.2365, 0.2558, 0.2753, 0.2948, 0.3142, 0.3332, 0.3517, 0.3693, 0.386, 0.4014, 0.4154, 0.4278, 0.4384, 0.447, 0.4537, 0.4581, 0.4604, 0.4604, 0.4581, 0.4537, 0.447, 0.4384, 0.4278, 0.4154, 0.4014, 0.386, 0.3693, 0.3517, 0.3332, 0.3142, 0.2948, 0.2753, 0.2558, 0.2365, 0.2176, 0.1993, 0.1815, 0.1646, 0.1485, 0.1334, 0.1191, 0.1059, 0.0937, 0.0825, 0.0723, 0.063, 0.0547, 0.0472, 0.0406, 0.0347, 0.0295, 0.025, 0.021, 0.0176, 0.0147, 0.0122, 0.0101, 0.0083, 0.0068, 0.0055, 0.0045, 0.0036, 0.0029, 0.0023, 0.0018, 0.0015, 0.0011],
            100: [0.0044, 0.0053, 0.0063, 0.0075, 0.0089, 0.0105, 0.0123, 0.0145, 0.0169, 0.0196, 0.0227, 0.0262, 0.0301, 0.0345, 0.0394, 0.0448, 0.0508, 0.0573, 0.0645, 0.0723, 0.0807, 0.0898, 0.0995, 0.1098, 0.1209, 0.1325, 0.1447, 0.1574, 0.1707, 0.1844, 0.1984, 0.2128, 0.2273, 0.242, 0.2566, 0.2712, 0.2855, 0.2994, 0.3129, 0.3258, 0.338, 0.3494, 0.3598, 0.3692, 0.3774, 0.3844, 0.3901, 0.3944, 0.3973, 0.3988, 0.3988, 0.3973, 0.3944, 0.3901, 0.3844, 0.3774, 0.3692, 0.3598, 0.3494, 0.338, 0.3258, 0.3129, 0.2994, 0.2855, 0.2712, 0.2566, 0.242, 0.2273, 0.2128, 0.1984, 0.1844, 0.1707, 0.1574, 0.1447, 0.1325, 0.1209, 0.1098, 0.0995, 0.0898, 0.0807, 0.0723, 0.0645, 0.0573, 0.0508, 0.0448, 0.0394, 0.0345, 0.0301, 0.0262, 0.0227, 0.0196, 0.0169, 0.0145, 0.0123, 0.0105, 0.0089, 0.0075, 0.0063, 0.0053, 0.0044]
        };

        this.chart.data.datasets[0].data = volatilitySeriesMap[volatility];
        this.updateChart();
    }

    attachChart() {
        this.chart = new Chart(this.canvas,{
            type: 'line',
            data: {
                labels: [25.0, 25.0606, 25.1212, 25.1818, 25.2424, 25.303, 25.3636, 25.4242, 25.4848, 25.5455, 25.6061, 25.6667, 25.7273, 25.7879, 25.8485, 25.9091, 25.9697, 26.0303, 26.0909, 26.1515, 26.2121, 26.2727, 26.3333, 26.3939, 26.4545, 26.5152, 26.5758, 26.6364, 26.697, 26.7576, 26.8182, 26.8788, 26.9394, 27.0, 27.0606, 27.1212, 27.1818, 27.2424, 27.303, 27.3636, 27.4242, 27.4848, 27.5455, 27.6061, 27.6667, 27.7273, 27.7879, 27.8485, 27.9091, 27.9697, 28.0303, 28.0909, 28.1515, 28.2121, 28.2727, 28.3333, 28.3939, 28.4545, 28.5152, 28.5758, 28.6364, 28.697, 28.7576, 28.8182, 28.8788, 28.9394, 29.0, 29.0606, 29.1212, 29.1818, 29.2424, 29.303, 29.3636, 29.4242, 29.4848, 29.5455, 29.6061, 29.6667, 29.7273, 29.7879, 29.8485, 29.9091, 29.9697, 30.0303, 30.0909, 30.1515, 30.2121, 30.2727, 30.3333, 30.3939, 30.4545, 30.5152, 30.5758, 30.6364, 30.697, 30.7576, 30.8182, 30.8788, 30.9394, 31.0],
                datasets: [
                    {
                        label: 'distribution',
                        data: [0.0001, 0.0001, 0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0007, 0.001, 0.0014, 0.0018, 0.0024, 0.0032, 0.0042, 0.0055, 0.0071, 0.0091, 0.0117, 0.0147, 0.0185, 0.0231, 0.0286, 0.0351, 0.0428, 0.0518, 0.0622, 0.0742, 0.0879, 0.1033, 0.1205, 0.1396, 0.1605, 0.1832, 0.2076, 0.2334, 0.2606, 0.2889, 0.3178, 0.3471, 0.3763, 0.405, 0.4327, 0.4589, 0.4831, 0.5049, 0.5237, 0.5394, 0.5514, 0.5595, 0.5637, 0.5637, 0.5595, 0.5514, 0.5394, 0.5237, 0.5049, 0.4831, 0.4589, 0.4327, 0.405, 0.3763, 0.3471, 0.3178, 0.2889, 0.2606, 0.2334, 0.2076, 0.1832, 0.1605, 0.1396, 0.1205, 0.1033, 0.0879, 0.0742, 0.0622, 0.0518, 0.0428, 0.0351, 0.0286, 0.0231, 0.0185, 0.0147, 0.0117, 0.0091, 0.0071, 0.0055, 0.0042, 0.0032, 0.0024, 0.0018, 0.0014, 0.001, 0.0007, 0.0005, 0.0004, 0.0003, 0.0002, 0.0001, 0.0001, 0.0001],
                        borderWidth: 1,
                        yAxisID: 'y',
                        borderColor: this.fourthColor,
                        backgroundColor: this.fourthColor
                    },
                    {
                        label: 'payoff',
                        data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0303, 0.0909, 0.1515, 0.2121, 0.2727, 0.3333, 0.3939, 0.4545, 0.5152, 0.5758, 0.6364, 0.697, 0.7576, 0.8182, 0.8788, 0.9394, 1.0, 1.0606, 1.1212, 1.1818, 1.2424, 1.303, 1.3636, 1.4242, 1.4848, 1.5455, 1.6061, 1.6667, 1.7273, 1.7879, 1.8485, 1.9091, 1.9697, 2.0303, 2.0909, 2.1515, 2.2121, 2.2727, 2.3333, 2.3939, 2.4545, 2.5152, 2.5758, 2.6364, 2.697, 2.7576, 2.8182, 2.8788, 2.9394, 3.0],
                        borderWidth: 1,
                        yAxisID: 'y1',
                        borderColor: this.fifthColor,
                        backgroundColor: this.fifthColor
                    },
                ]
            },
            options: {
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Stock price'
                        },
                        type: 'linear',
                        grid: {
                            display: false
                        },
                        ticks: {
                            callback: function(value,index,ticks) {
                                return '$' + value.toFixed(2).toLocaleString();
                            }
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Probability density'
                        },
                        min: 0,
                        max: 1.4,
                        stepSize: .2
                    },
                    y1: {
                        title: {
                            display: true,
                            text: 'Payoff'
                        },
                        grid: {
                            display: false
                        },
                        position: 'right',
                        ticks: {
                            callback: function(value,index,ticks) {
                                return '$' + value.toFixed(2).toLocaleString();
                            }
                        }
                    }
                }
            }
        })
    }
}